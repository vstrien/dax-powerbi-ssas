<!DOCTYPE html>
<html>
<head>
<title>10-datatypes-minilab.md</title>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">

<style>
/* https://github.com/microsoft/vscode/blob/master/extensions/markdown-language-features/media/markdown.css */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

body {
	font-family: var(--vscode-markdown-font-family, -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif);
	font-size: var(--vscode-markdown-font-size, 14px);
	padding: 0 26px;
	line-height: var(--vscode-markdown-line-height, 22px);
	word-wrap: break-word;
}

#code-csp-warning {
	position: fixed;
	top: 0;
	right: 0;
	color: white;
	margin: 16px;
	text-align: center;
	font-size: 12px;
	font-family: sans-serif;
	background-color:#444444;
	cursor: pointer;
	padding: 6px;
	box-shadow: 1px 1px 1px rgba(0,0,0,.25);
}

#code-csp-warning:hover {
	text-decoration: none;
	background-color:#007acc;
	box-shadow: 2px 2px 2px rgba(0,0,0,.25);
}

body.scrollBeyondLastLine {
	margin-bottom: calc(100vh - 22px);
}

body.showEditorSelection .code-line {
	position: relative;
}

body.showEditorSelection .code-active-line:before,
body.showEditorSelection .code-line:hover:before {
	content: "";
	display: block;
	position: absolute;
	top: 0;
	left: -12px;
	height: 100%;
}

body.showEditorSelection li.code-active-line:before,
body.showEditorSelection li.code-line:hover:before {
	left: -30px;
}

.vscode-light.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(0, 0, 0, 0.15);
}

.vscode-light.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(0, 0, 0, 0.40);
}

.vscode-light.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-dark.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 255, 255, 0.4);
}

.vscode-dark.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 255, 255, 0.60);
}

.vscode-dark.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-high-contrast.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 160, 0, 0.7);
}

.vscode-high-contrast.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 160, 0, 1);
}

.vscode-high-contrast.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

img {
	max-width: 100%;
	max-height: 100%;
}

a {
	text-decoration: none;
}

a:hover {
	text-decoration: underline;
}

a:focus,
input:focus,
select:focus,
textarea:focus {
	outline: 1px solid -webkit-focus-ring-color;
	outline-offset: -1px;
}

hr {
	border: 0;
	height: 2px;
	border-bottom: 2px solid;
}

h1 {
	padding-bottom: 0.3em;
	line-height: 1.2;
	border-bottom-width: 1px;
	border-bottom-style: solid;
}

h1, h2, h3 {
	font-weight: normal;
}

table {
	border-collapse: collapse;
}

table > thead > tr > th {
	text-align: left;
	border-bottom: 1px solid;
}

table > thead > tr > th,
table > thead > tr > td,
table > tbody > tr > th,
table > tbody > tr > td {
	padding: 5px 10px;
}

table > tbody > tr + tr > td {
	border-top: 1px solid;
}

blockquote {
	margin: 0 7px 0 5px;
	padding: 0 16px 0 10px;
	border-left-width: 5px;
	border-left-style: solid;
}

code {
	font-family: Menlo, Monaco, Consolas, "Droid Sans Mono", "Courier New", monospace, "Droid Sans Fallback";
	font-size: 1em;
	line-height: 1.357em;
}

body.wordWrap pre {
	white-space: pre-wrap;
}

pre:not(.hljs),
pre.hljs code > div {
	padding: 16px;
	border-radius: 3px;
	overflow: auto;
}

pre code {
	color: var(--vscode-editor-foreground);
	tab-size: 4;
}

/** Theming */

.vscode-light pre {
	background-color: rgba(220, 220, 220, 0.4);
}

.vscode-dark pre {
	background-color: rgba(10, 10, 10, 0.4);
}

.vscode-high-contrast pre {
	background-color: rgb(0, 0, 0);
}

.vscode-high-contrast h1 {
	border-color: rgb(0, 0, 0);
}

.vscode-light table > thead > tr > th {
	border-color: rgba(0, 0, 0, 0.69);
}

.vscode-dark table > thead > tr > th {
	border-color: rgba(255, 255, 255, 0.69);
}

.vscode-light h1,
.vscode-light hr,
.vscode-light table > tbody > tr + tr > td {
	border-color: rgba(0, 0, 0, 0.18);
}

.vscode-dark h1,
.vscode-dark hr,
.vscode-dark table > tbody > tr + tr > td {
	border-color: rgba(255, 255, 255, 0.18);
}

</style>

<style>
/* Tomorrow Theme */
/* http://jmblog.github.com/color-themes-for-google-code-highlightjs */
/* Original theme - https://github.com/chriskempson/tomorrow-theme */

/* Tomorrow Comment */
.hljs-comment,
.hljs-quote {
	color: #8e908c;
}

/* Tomorrow Red */
.hljs-variable,
.hljs-template-variable,
.hljs-tag,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class,
.hljs-regexp,
.hljs-deletion {
	color: #c82829;
}

/* Tomorrow Orange */
.hljs-number,
.hljs-built_in,
.hljs-builtin-name,
.hljs-literal,
.hljs-type,
.hljs-params,
.hljs-meta,
.hljs-link {
	color: #f5871f;
}

/* Tomorrow Yellow */
.hljs-attribute {
	color: #eab700;
}

/* Tomorrow Green */
.hljs-string,
.hljs-symbol,
.hljs-bullet,
.hljs-addition {
	color: #718c00;
}

/* Tomorrow Blue */
.hljs-title,
.hljs-section {
	color: #4271ae;
}

/* Tomorrow Purple */
.hljs-keyword,
.hljs-selector-tag {
	color: #8959a8;
}

.hljs {
	display: block;
	overflow-x: auto;
	color: #4d4d4c;
	padding: 0.5em;
}

.hljs-emphasis {
	font-style: italic;
}

.hljs-strong {
	font-weight: bold;
}
</style>

<style>
/*
 * Markdown PDF CSS
 */

 body {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif, "Meiryo";
	padding: 0 12px;
}

pre {
	background-color: #f8f8f8;
	border: 1px solid #cccccc;
	border-radius: 3px;
	overflow-x: auto;
	white-space: pre-wrap;
	overflow-wrap: break-word;
}

pre:not(.hljs) {
	padding: 23px;
	line-height: 19px;
}

blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.emoji {
	height: 1.4em;
}

code {
	font-size: 14px;
	line-height: 19px;
}

/* for inline code */
:not(pre):not(.hljs) > code {
	color: #C9AE75; /* Change the old color so it seems less like an error */
	font-size: inherit;
}

/* Page Break : use <div class="page"/> to insert page break
-------------------------------------------------------- */
.page {
	page-break-after: always;
}

</style>

<script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
</head>
<body>
  <script>
    mermaid.initialize({
      startOnLoad: true,
      theme: document.body.classList.contains('vscode-dark') || document.body.classList.contains('vscode-high-contrast')
          ? 'dark'
          : 'default'
    });
  </script>
<h1 id="datatypes">Datatypes</h1>
<p>In dit <em>mini-lab</em> gaan we aan de slag met datatypes in DAX. We hebben daarvoor een bestand uitgekozen waarin bewust alle datatypes op <em>tekst</em> staan. Daar gaan we wat aan veranderen in het datamodel.</p>
<h2 id="video">Video</h2>
<p>Bekijk eerst onderstaande video. Hierin krijg je een kort overzicht van de verschillende datatypes die er in DAX aanwezig zijn, en hoe je hiermee kunt omgaan.</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/_pxvvhDuOVA" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<h2 id="getallen-versus-tekst---de-opslag">Getallen versus tekst - de opslag</h2>
<ol start="0">
<li>Bekijk het Power BI-bestand <code>11-datatypes-minilab</code> met Windows Verkenner. Merk op dat het bestand nu 5,89 MB is (6.042 kB)</li>
<li>Open het Power BI-bestand <code>11-datatypes-minilab</code></li>
<li>Schakel naar de <strong>Gegevens</strong> weergave binnen Power BI</li>
<li>Selecteer de kolom <strong>Order Key</strong></li>
<li>Stel het <strong>Gegevenstype</strong> in op <strong>Geheel getal</strong>. Bevestig dat je dit echt wilt doen.</li>
<li>Sla het bestand opnieuw op, en bekijk het formaat van het bestand met Windows Verkenner. Merk op dat het bestand nu bijna 10% kleiner is geworden - ca. 5,27 MB (5.402 kB)</li>
</ol>
<p>Verander ook de volgende kolommen in <strong>Geheel getal</strong>:</p>
<ul>
<li>City Key</li>
<li>Customer Key</li>
<li>Stock Item Key</li>
<li>Salesperson Key</li>
<li>Picker Key</li>
<li>WWI Order ID</li>
<li>WWI Backorder ID</li>
<li>Quantity</li>
</ul>
<p>Wanneer je het bestand nu bekijkt met Verkenner, zie je dat het weliswaar iets kleiner geworden is, maar niet heel veel (ca. 5,21 MB / 5.346 kB). De reden hiervoor is tweeledig:</p>
<ul>
<li>Getallen nemen (over het algemeen) minder ruimte in dan tekst. Daarom worden de bestanden telkens kleiner</li>
<li>Power BI slaat data per kolom op. We kijken later naar wat dat precies betekent, maar één tipje van de sluier kunnen we wel vast oplichten: als waarden meerdere keren voorkomen, nemen ze niet twee keer zoveel ruimte in.</li>
</ul>
<p><strong>Order Key</strong> was een kolom met 231.412 unieke waarden - als je dan van tekst- naar getallen-opslag gaat, tikt dat dus extra hard aan.</p>
<h2 id="datums-en-tijden">Datums en tijden</h2>
<ol start="6">
<li>Stel nu de kolom <strong>Order Date</strong> in op het datatype <strong>Datum</strong>. Merk op dat je ook een indeling kunt kiezen - kies hier 'dd-mm-yy' (14-03-01).</li>
<li>Probeer nu de kolom <strong>Picked Date Key</strong> in te stellen op <strong>Datum</strong>. Je krijgt de volgende foutmelding:</li>
</ol>
<p><img src="img/10-02-datumwerktniet.png" alt="Foutmelding - datum omzetten kan niet"></p>
<p>De reden dat dit niet lukt, is dat er een <strong>lege tekstwaarde</strong> in de kolom aanwezig is. En hoewel een &quot;echte&quot; ontbrekende waarde (<code>BLANK</code> in Power BI) geen probleem is (die bestaat ook in een datumkolom), is een lege tekst een ongeldige datum.</p>
<ol start="8">
<li>Hernoem de kolom <strong>Picked Date Key</strong> naar <strong>Picked Date Key SOURCE</strong></li>
<li>Maak een nieuwe kolom <strong>Picked Date Key</strong> met de volgende definitie:</li>
</ol>
<pre class="hljs"><code><div>Picked Date Key = IF([Picked Date Key SOURCE] = &quot;&quot;; BLANK(); [Picked Date Key SOURCE])
</div></code></pre>
<ol start="10">
<li>Probeer nu deze nieuwe kolom <strong>Picked Date Key</strong> in te stellen op datatype <strong>datum</strong>. Verberg de oude kolom voor de rapportageweergave.</li>
</ol>
<h2 id="decimale-getallen">Decimale getallen</h2>
<ol start="11">
<li>Stel de kolom <strong>Unit Price</strong> in op het datatype <strong>Vast Decimaal getal</strong>. Kies voor een indeling <strong>Valuta</strong>, met twee cijfers achter de komma.</li>
</ol>
<blockquote>
<p>Als stap 11 niet lukt, komt dit doordat er een punt gebruikt wordt als decimaal scheidingsteken (dus er staat 13.00, maar volgens een Nederlandse Windows-installatie moet dat 13**,**00 zijn). Volg hiervoor hetzelfde patroon als hierboven:</p>
<ul>
<li>Hernoem de kolom <strong>Unit Price</strong> naar <strong>Unit Price SOURCE</strong></li>
<li>Maak een nieuwe kolom <strong>Unit Price</strong></li>
<li>Gebruik de DAX-functie <strong>SUBSTITUTE</strong> om de punt te vervangen door een komma</li>
<li>Probeer nu de nieuwe kolom op te slaan als <strong>Vast decimaal getal</strong></li>
<li><strong>Verberg</strong> de kolom <strong>Unit Price SOURCE</strong></li>
</ul>
</blockquote>
<h2 id="terugblik">Terugblik</h2>
<p>We hebben zojuist enkele aanpassingen in ons datamodel gemaakt met betrekking tot datatypes. De meeste aanpassingen aan datatypes doe je echter gedurende het inladen van data - niet in je DAX datamodel. Dat kan bijvoorbeeld in het ETL-proces van je Data Warehouse, of in een Power Query-definitie binnen Power BI of Analysis Services. Het is daar veel eenvoudiger om lege waarden weg te laten, punten door komma's te vervangen en rekening te houden met regionale instellingen van een bronbestand. En je hoeft de &quot;onderliggende&quot; kolommen (waar we nu <strong>SOURCE</strong> achter gezet hebben) niet mee te nemen in je model. Daarmee blijft je model overzichtelijker, kleiner en sneller.</p>

</body>
</html>
